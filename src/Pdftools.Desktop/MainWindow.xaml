<Window x:Class="Pdftools.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="发票打印工具" Height="720" Width="1080">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 顶部工具栏：明确两排布局，第一排为导入/设备/模板/参数，第二排为动作按钮 -->
        <StackPanel Margin="12" Grid.Row="0">
          <Menu>
            <MenuItem Header="设置">
              <MenuItem Header="模板管理" Click="BtnTemplates_Click"/>
              <MenuItem Header="高级工具" Click="BtnOpenTools_Click"/>
            </MenuItem>
          </Menu>
          <WrapPanel Margin="8,4,0,0">
            <Button x:Name="BtnOpenFile" Content="导入文件" Margin="0,0,8,0" Click="BtnOpenFile_Click"/>
            <Button Content="导入文件夹" Margin="0,0,8,0" Click="BtnOpenFolder_Click"/>
            <TextBlock Text="打印机:" VerticalAlignment="Center" Margin="12,0,4,0"/>
            <ComboBox x:Name="PrinterCombo" Width="280" Margin="0,0,12,0" SelectionChanged="PrinterCombo_SelectionChanged"/>
            <Button Content="打印全部" Margin="0,0,8,0" Click="BtnPrintAll_Click"/>
            <Button Content="打印测试页" Margin="0,0,8,0" Click="BtnPrintTest_Click"/>
            <Separator Width="16" Background="Transparent"/>
            <Button Content="图片→PDF" Margin="0,0,8,0" Click="BtnImagesToPdf_Click"/>
            <Button Content="PDF→图片" Margin="0,0,8,0" Click="BtnPdfToImages_Click"/>
          </WrapPanel>
        </StackPanel>

        <!-- 中部：左侧文件列表占位，右侧预览 -->
        <Grid Grid.Row="1" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <DataGrid Grid.Column="0" AutoGenerateColumns="False" Margin="0,0,8,0" ItemsSource="{Binding Files}" SelectionChanged="FilesGrid_SelectionChanged" AllowDrop="True" Drop="FilesGrid_Drop">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="*"/>
                    <DataGridTextColumn Header="页数" Binding="{Binding PageCount}" Width="80"/>
                    <DataGridTextColumn Header="尺寸" Binding="{Binding Size}" Width="120"/>
                    <DataGridTextColumn Header="状态" Binding="{Binding Status}" Width="120"/>
                    <DataGridTextColumn Header="结果" Binding="{Binding Message}" Width="200"/>
                </DataGrid.Columns>
            </DataGrid>

            <Border Grid.Column="1" BorderBrush="#DDD" BorderThickness="1" Padding="8">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                    <Image x:Name="PreviewImage" Stretch="Uniform"/>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- 底部状态栏占位 -->
        <StatusBar Grid.Row="2">
            <StatusBarItem x:Name="StatusText" Content="就绪"/>
            <Separator/>
            <StatusBarItem x:Name="StatusInfo" Content=""/>
            <Separator/>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="进度:" Margin="0,0,4,0"/>
                    <ProgressBar x:Name="BatchProgress" Width="200" Height="14" Minimum="0" Maximum="100"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem x:Name="StatusCount" Content=""/>
        </StatusBar>
    </Grid>
</Window>
